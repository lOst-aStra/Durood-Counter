# Story 1.2: Counter UI with +1 action

## Status
Done

## Story
As a user,
I want a large +1 button to increment the counter,
so that I can recite and track counts easily. [Source: docs/prd/epic-1-foundation-core-counter.md]

## Acceptance Criteria
1. Large, centered +1 button increments visible counter [Source: docs/prd/epic-1-foundation-core-counter.md]
2. Counter is legible with rounded numeric font (e.g., Nunito; tabular numerals if available) [Source: docs/prd/epic-1-foundation-core-counter.md]
3. Arabic Durood header visible with RTL support [Source: docs/prd/epic-1-foundation-core-counter.md]

## Tasks / Subtasks
- [x] Implement `DuroodScreen()` layout scaffold with content area (AC: 1, 3)
  - [x] Place `HeaderArabic()` at the top; ensure RTL support via `android:supportsRtl="true"` and use Noto Naskh Arabic font [Source: docs/architecture-shards/ui-composition.md]
  - [x] Place `CounterCard()` centrally to display current count using Nunito with tabular numerals if available [Source: docs/architecture-shards/ui-composition.md]
  - [x] Place `PrimaryButton()` as a dominant large +1 action, centered with accessible hit target â‰¥ 48dp [Source: docs/architecture-shards/ui-composition.md]
- [x] Wire `PrimaryButton()` to `CounterViewModel.onIncrement()` to update state and reflect immediately in `CounterCard()` (AC: 1) [Source: docs/architecture-shards/viewmodel-and-state.md]
- [x] Ensure typography setup uses bundled fonts in `res/font/` and `Type.kt` integrates `FontFamily` for Nunito and Noto Naskh Arabic (AC: 2, 3) [Source: docs/architecture-shards/ui-composition.md]
- [x] Maintain package and file locations per structure (no navigation yet) [Source: docs/architecture-shards/modules-and-packages.md]
- [x] Haptics hook prepared but disabled for this story (actual feedback in Story 1.4) [Source: docs/architecture-shards/ui-composition.md]
- [x] Unit/UI tests:
  - [x] Compose UI test: tapping +1 increments visible counter (AC: 1) [Source: docs/architecture-shards/testing-strategy.md]
  - [x] Tag key nodes (e.g., `testTag("counter-value")`, `testTag("primary-plus1")`) [Source: docs/architecture-shards/testing-strategy.md]

## Dev Notes

### Previous Story Insights
- App scaffold, theming, and fonts were established in Story 1.1. Compose M3 is active and `supportsRtl` is set. Use the existing theme and typography as baseline. [Source: docs/stories/1.1.initialize-android-app-skeleton.md]

### Component Specifications
- UI composition components relevant to this story:
  - `DuroodScreen()` provides the Scaffold and content area. [Source: docs/architecture-shards/ui-composition.md]
  - `HeaderArabic()` shows Arabic Durood Shareef text; use Noto Naskh Arabic font, be RTL-aware. [Source: docs/architecture-shards/ui-composition.md]
  - `CounterCard()` displays the prominent numeric value using Nunito with tabular numerals if available. [Source: docs/architecture-shards/ui-composition.md]
  - `PrimaryButton()` is the large +1 action with dominant visual weight. [Source: docs/architecture-shards/ui-composition.md]

### ViewModel and Intents
- `CounterViewModel` exposes `state: StateFlow<CounterState>` with `current`, `completedSets`, etc. Use `onIncrement()` to mutate the state. [Source: docs/architecture-shards/viewmodel-and-state.md]

### Business Logic
- Increment logic rolls over on base 100 and updates `completed_sets` when wrapping. UI must simply invoke the intent; repository-level logic will handle rollover in later stories when persistence is added. [Source: docs/architecture-shards/business-logic.md]

### File Locations
- Follow package structure: `ui/` for composables, `presentation/` for ViewModel/State. Component files such as `DuroodScreen.kt`, `components/HeaderArabic.kt`, `components/CounterCard.kt`, and `components/PrimaryButton.kt`. [Source: docs/architecture-shards/modules-and-packages.md]

### Typography & Fonts
- Fonts already bundled in `app/src/main/res/font/`. Ensure `Type.kt` wires Nunito (tabular numerals if available) for numeric display and Noto Naskh Arabic for header. [Source: docs/architecture-shards/ui-composition.md]

### RTL & Localization
- Ensure `AndroidManifest.xml` includes `android:supportsRtl="true"` (already set in 1.1). Apply RTL layout direction to Arabic header if needed. [Source: docs/architecture-shards/ui-composition.md]

### Testing Requirements
- Compose UI tests for +1 increment and visibility of updated counter value. Use test tags for robust selection. [Source: docs/architecture-shards/testing-strategy.md]

### Performance Considerations
- Keep recompositions minimal; scope state correctly. Avoid heavy work in `onCreate`. [Source: docs/architecture-shards/performance.md]

### Build & Dependencies
- Ensure dependencies are present per build guidance (Compose BOM, Activity Compose). Already configured in Story 1.1. [Source: docs/architecture-shards/build-and-dependencies.md]

## Testing
- Unit/UI: Verify tapping +1 increments displayed value. Consider basic UI test using `compose-ui-test` with test tags. [Source: docs/architecture-shards/testing-strategy.md]

## Change Log
| Date       | Version | Description                                 | Author |
|------------|---------|---------------------------------------------|--------|
| 2025-09-14 | 0.1     | Initial draft from PRD + Architecture shards | SM     |
| 2025-09-14 | 0.2     | Implemented UI, wiring, RTL, tests, and resources | Dev |

## Dev Agent Record
- Agent Model Used: Cascade
- Debug Log References:
  - Implemented UI structure per story: `DuroodScreen`, `HeaderArabic`, `CounterCard`, `PrimaryButton`.
  - Wired `PrimaryButton` to `CounterViewModel.onIncrement()`; added `onIncrement()` alias in ViewModel.
  - Ensured RTL for Arabic header via `CompositionLocalProvider(LocalLayoutDirection.Rtl)` and Noto Naskh Arabic font usage.
  - Added lifecycle compose deps for `viewModel()` and `collectAsStateWithLifecycle`.
  - Created Compose UI test `DuroodScreenTest.plusOneIncrementsCounter` using test tags.
  - Header text moved to resources with full Durood Shareef string; increased `maxLines` to 3 for wrapping.
- Completion Notes List:
  - UI meets AC #1 visually and interaction-wise (large +1 increments counter) pending validation run.
  - Typography uses Nunito for numerals and Noto Naskh Arabic for header; fonts sourced from `res/font/`.
  - Manifest already had `android:supportsRtl="true"` from Story 1.1.
  - Haptics hook parameter present but disabled by default in `PrimaryButton`.
- File List:
  - `app/src/main/java/com/lostastra/duroodcounter/ui/DuroodScreen.kt` (new)
  - `app/src/main/java/com/lostastra/duroodcounter/ui/components/HeaderArabic.kt` (new)
  - `app/src/main/java/com/lostastra/duroodcounter/ui/components/CounterCard.kt` (new)
  - `app/src/main/java/com/lostastra/duroodcounter/ui/components/PrimaryButton.kt` (new)
  - `app/src/main/java/com/lostastra/duroodcounter/MainActivity.kt` (modified)
  - `app/src/main/java/com/lostastra/duroodcounter/ui/theme/Type.kt` (modified)
  - `app/src/androidTest/java/com/lostastra/duroodcounter/DuroodScreenTest.kt` (new)
  - `app/build.gradle.kts` (modified)
  - `app/src/main/res/values/strings.xml` (new)

## QA Results
- Pending
